# bugï¼Œsglang can't output annotation, such as "<||>". 
# if you change to another model, no error.
# launch the offline engine
import sglang as sgl

if __name__ == "__main__":
    llm = sgl.Engine(model_path="athirdpath/Llama-3-15b-Instruct")
    prompts = [
        "<|begin_of_text|><|start_header_id|>user<|end_header_id|>\n\nWhat's the capital of Spain?<|eot_id|><|start_header_id|>assistant<|end_header_id|>\n\n"
    ]

    sampling_params = {"temperature": 0.8, "top_p": 0.95}

    outputs = llm.generate(prompts, sampling_params)
    print(outputs)